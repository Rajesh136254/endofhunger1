{"ast":null,"code":"// src/pages/QrCodesPage.js (Final, Clean Version)\nimport React,{useState,useEffect,useRef}from'react';import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";function QrCodesPage(){const[tables,setTables]=useState([]);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const qrRefs=useRef({});const BASE_URL=window.location.origin;const API_URL='http://localhost:5000';// Force use of backend server\nconst loadTables=async()=>{try{const response=await fetch(\"\".concat(API_URL,\"/api/tables\"));const data=await response.json();if(data.success){setTables(data.data||[]);}else{// Fallback to mock data if API fails\nsetTables(Array.from({length:12},(_,i)=>({id:i+1,table_number:i+1,table_name:\"Table \".concat(i+1),qr_code_data:\"\".concat(BASE_URL,\"/customer.html?table=\").concat(i+1)})));}}catch(err){console.error(\"Failed to load tables:\",err);setError(\"Failed to load tables.\");// Fallback to mock data if API fails\nsetTables(Array.from({length:12},(_,i)=>({id:i+1,table_number:i+1,table_name:\"Table \".concat(i+1),qr_code_data:\"\".concat(BASE_URL,\"/customer.html?table=\").concat(i+1)})));}finally{setIsLoading(false);}};useEffect(()=>{// Load QRCode library\nconst script=document.createElement('script');script.src='https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js';script.async=true;script.onload=()=>{loadTables();};document.body.appendChild(script);return()=>{document.body.removeChild(script);};},[]);useEffect(()=>{// Ensure the library is ready and we have tables\nif(typeof window.QRCode==='undefined'||tables.length===0){return;}tables.forEach(table=>{const container=qrRefs.current[table.id];if(container&&container.children.length===0){new window.QRCode(container,{text:table.qr_code_data||\"\".concat(BASE_URL,\"/customer.html?table=\").concat(table.table_number),width:200,height:200});}});},[tables]);const printQR=tableId=>{var _document$getElementB;const element=(_document$getElementB=document.getElementById(\"qr-\".concat(tableId)))===null||_document$getElementB===void 0?void 0:_document$getElementB.parentElement;if(!element)return;const printWindow=window.open('','','width=800,height=600');printWindow.document.write(\"\\n            <html>\\n                <head><title>Print QR Code</title><style>body{font-family:sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;}.qr-print{text-align:center;padding:40px;}@page{margin:0;}</style></head>\\n                <body><div class=\\\"qr-print\\\">\".concat(element.innerHTML,\"</div></body>\\n            </html>\\n        \"));printWindow.document.close();printWindow.focus();setTimeout(()=>{printWindow.print();printWindow.close();},500);};if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 text-center text-red-600\",children:[\"Error: \",error]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white p-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold\",children:\"\\uD83D\\uDCF1 QR Codes for Tables\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-indigo-100\",children:\"Scan to Order\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Instructions:\"}),\" Print these QR codes and place them on respective tables.\"]})}),isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Loading tables...\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",children:tables.map(table=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg p-6 text-center\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-2xl font-bold mb-4 text-gray-900\",children:[\"Table \",table.table_number]}),/*#__PURE__*/_jsx(\"div\",{id:\"qr-\".concat(table.id),ref:el=>qrRefs.current[table.id]=el,className:\"flex justify-center mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-3\",children:table.table_name}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>printQR(table.id),className:\"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg w-full\",children:\"\\uD83D\\uDDA8\\uFE0F Print QR Code\"})]},table.id))})]})]});}export default QrCodesPage;","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","QrCodesPage","tables","setTables","isLoading","setIsLoading","error","setError","qrRefs","BASE_URL","window","location","origin","API_URL","loadTables","response","fetch","concat","data","json","success","Array","from","length","_","i","id","table_number","table_name","qr_code_data","err","console","script","document","createElement","src","async","onload","body","appendChild","removeChild","QRCode","forEach","table","container","current","children","text","width","height","printQR","tableId","_document$getElementB","element","getElementById","parentElement","printWindow","open","write","innerHTML","close","focus","setTimeout","print","className","map","ref","el","onClick"],"sources":["/home/user/endofhunger/dineflowreact/src/pages/QrCodesPage.js"],"sourcesContent":["// src/pages/QrCodesPage.js (Final, Clean Version)\r\nimport React, { useState, useEffect, useRef } from 'react';\r\n\r\nfunction QrCodesPage() {\r\n    const [tables, setTables] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const qrRefs = useRef({});\r\n    const BASE_URL = window.location.origin;\r\n    const API_URL = 'http://localhost:5000'; // Force use of backend server\r\n\r\n    const loadTables = async () => {\r\n        try {\r\n            const response = await fetch(`${API_URL}/api/tables`);\r\n            const data = await response.json();\r\n            if (data.success) {\r\n                setTables(data.data || []);\r\n            } else {\r\n                // Fallback to mock data if API fails\r\n                setTables(Array.from({ length: 12 }, (_, i) => ({ \r\n                    id: i + 1, \r\n                    table_number: i + 1, \r\n                    table_name: `Table ${i + 1}`,\r\n                    qr_code_data: `${BASE_URL}/customer.html?table=${i + 1}`\r\n                })));\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Failed to load tables:\", err);\r\n            setError(\"Failed to load tables.\");\r\n            // Fallback to mock data if API fails\r\n            setTables(Array.from({ length: 12 }, (_, i) => ({ \r\n                id: i + 1, \r\n                table_number: i + 1, \r\n                table_name: `Table ${i + 1}`,\r\n                qr_code_data: `${BASE_URL}/customer.html?table=${i + 1}`\r\n            })));\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Load QRCode library\r\n        const script = document.createElement('script');\r\n        script.src = 'https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js';\r\n        script.async = true;\r\n        script.onload = () => {\r\n            loadTables();\r\n        };\r\n        document.body.appendChild(script);\r\n        \r\n        return () => {\r\n            document.body.removeChild(script);\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Ensure the library is ready and we have tables\r\n        if (typeof window.QRCode === 'undefined' || tables.length === 0) {\r\n            return;\r\n        }\r\n        tables.forEach(table => {\r\n            const container = qrRefs.current[table.id];\r\n            if (container && container.children.length === 0) {\r\n                new window.QRCode(container, {\r\n                    text: table.qr_code_data || `${BASE_URL}/customer.html?table=${table.table_number}`,\r\n                    width: 200,\r\n                    height: 200,\r\n                });\r\n            }\r\n        });\r\n    }, [tables]);\r\n\r\n    const printQR = (tableId) => {\r\n        const element = document.getElementById(`qr-${tableId}`)?.parentElement;\r\n        if (!element) return;\r\n        const printWindow = window.open('', '', 'width=800,height=600');\r\n        printWindow.document.write(`\r\n            <html>\r\n                <head><title>Print QR Code</title><style>body{font-family:sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;}.qr-print{text-align:center;padding:40px;}@page{margin:0;}</style></head>\r\n                <body><div class=\"qr-print\">${element.innerHTML}</div></body>\r\n            </html>\r\n        `);\r\n        printWindow.document.close();\r\n        printWindow.focus();\r\n        setTimeout(() => { printWindow.print(); printWindow.close(); }, 500);\r\n    };\r\n\r\n    if (error) {\r\n        return <div className=\"p-4 text-center text-red-600\">Error: {error}</div>;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white p-6\">\r\n                <h1 className=\"text-3xl font-bold\">üì± QR Codes for Tables</h1>\r\n                <p className=\"text-indigo-100\">Scan to Order</p>\r\n            </div>\r\n            <div className=\"p-4\">\r\n                <div className=\"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                    <p className=\"text-blue-800\"><strong>Instructions:</strong> Print these QR codes and place them on respective tables.</p>\r\n                </div>\r\n                {isLoading ? (\r\n                    <div className=\"text-center py-12\"><p className=\"text-gray-500\">Loading tables...</p></div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\r\n                        {tables.map(table => (\r\n                            <div key={table.id} className=\"bg-white rounded-lg shadow-lg p-6 text-center\">\r\n                                <h3 className=\"text-2xl font-bold mb-4 text-gray-900\">Table {table.table_number}</h3>\r\n                                <div id={`qr-${table.id}`} ref={el => qrRefs.current[table.id] = el} className=\"flex justify-center mb-4\"></div>\r\n                                <p className=\"text-sm text-gray-600 mb-3\">{table.table_name}</p>\r\n                                <button onClick={() => printQR(table.id)} className=\"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg w-full\">\r\n                                    üñ®Ô∏è Print QR Code\r\n                                </button>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default QrCodesPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}